<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 æ˜Ÿäº‘ç¥æ„¿ (å®Œç¾ç‰ˆ)</title>
    <!-- å¼•å…¥è‰ºæœ¯å­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; overflow: hidden; background-color: #020205; font-family: 'Noto Serif SC', serif; }
        
        #input-video { display: none; }
        
        /* èƒŒæ™¯ï¼šæ·±ç©ºæ¸å˜ */
        #canvas-container { 
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1;
            background: radial-gradient(circle at center, #111520 0%, #000000 100%);
        }

        /* --- é¡¶éƒ¨æ ‡é¢˜ --- */
        #top-header {
            position: fixed; top: 30px; left: 0; width: 100%;
            text-align: center; z-index: 10;
            pointer-events: none;
            opacity: 0; animation: fadeIn 2s ease forwards 0.5s;
        }
        
        .header-text {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 3.5rem;
            /* ç‚«å½©æµå…‰æ¸å˜ */
            background: linear-gradient(to right, #ffd700, #ff0055, #00f3ff, #ffd700);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.4));
            animation: shine 5s linear infinite;
        }

        @keyframes shine { to { background-position: 200% center; } }
        @keyframes fadeIn { to { opacity: 1; } }

        /* --- åŠ è½½å±‚ --- */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.8s ease;
        }
        .loader {
            width: 40px; height: 40px; border: 2px solid rgba(255,255,255,0.1);
            border-top-color: #00f3ff; border-radius: 50%;
            animation: spin 1s infinite linear; margin-bottom: 20px;
        }
        .loading-text { color: #00f3ff; font-size: 14px; letter-spacing: 2px; margin-bottom: 10px; }
        .skip-btn {
            padding: 8px 20px; border: 1px solid #333; color: #666; background: transparent;
            border-radius: 20px; cursor: pointer; font-size: 12px; margin-top: 20px;
            transition: all 0.3s;
        }
        .skip-btn:hover { border-color: #fff; color: #fff; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- ä¸»å¡ç‰‡ --- */
        #card-stage {
            position: fixed; top: 50%; left: 50%;
            width: 380px; height: 620px;
            transform: translate(-50%, -50%) perspective(1500px) rotateY(90deg) scale(0.6);
            transform-style: preserve-3d;
            z-index: 20; opacity: 0; pointer-events: none;
            transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.5s;
        }
        #card-stage.active {
            opacity: 1; pointer-events: auto;
            transform: translate(-50%, -50%) perspective(1500px) rotateY(0deg) scale(1);
        }
        .glass-card {
            width: 100%; height: 100%; border-radius: 24px;
            background: rgba(20, 25, 40, 0.8);
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; color: #fff; 
            /* è°ƒæ•´å†…è¾¹è·ï¼Œç»™æ–‡å­—æ›´å¤šæ¨ªå‘ç©ºé—´ */
            padding: 40px 10px; 
            box-sizing: border-box;
            position: relative; overflow: hidden;
        }
        .glass-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px;
            background: linear-gradient(90deg, transparent, #00f3ff, transparent);
            box-shadow: 0 0 20px #00f3ff;
        }
        .big-word {
            font-family: 'Ma Shan Zheng', cursive; 
            /* ä¿®æ”¹è¿™é‡Œï¼šè°ƒæ•´å­—å·å¹¶å¼ºåˆ¶ä¸æ¢è¡Œ */
            font-size: 4.2rem; 
            white-space: nowrap; 
            margin: 30px 0;
            background: linear-gradient(to bottom, #fff, #8beeff);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 20px rgba(0, 243, 255, 0.4));
        }
        .big-desc { font-size: 1.2rem; color: #ddd; line-height: 1.8; font-weight: 300; padding: 0 20px; }
        
        /* åº•éƒ¨æç¤º */
        #hud {
            position: fixed; bottom: 30px; width: 100%; text-align: center;
            color: rgba(255,255,255,0.4); font-size: 13px; letter-spacing: 2px;
            z-index: 10; pointer-events: none;
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 600px) {
            .header-text { font-size: 2.2rem; }
            #card-stage { width: 300px; height: 500px; }
            .big-word { font-size: 3.5rem; }
            #hud { font-size: 12px; width: 90%; left: 5%; }
        }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
</head>
<body>

    <div id="loading-screen">
        <div class="loader"></div>
        <div class="loading-text" id="load-txt">æ­£åœ¨è£…è½½2026å¹´å¥½è¿...</div>
        <div class="loading-text" style="font-size: 12px; color: #666;" id="sub-txt">å¦‚æœå¡ä½ï¼Œè¯·æ£€æŸ¥æ‘„åƒå¤´æƒé™</div>
        <button class="skip-btn" onclick="forceStart()">è·³è¿‡è§†è§‰è¯†åˆ«ï¼ˆä»…ç‚¹å‡»æ¨¡å¼ï¼‰</button>
    </div>

    <!-- é¡¶éƒ¨æ ‡é¢˜ -->
    <div id="top-header">
        <div class="header-text"> 2026ç¥æ‚¨ï¼š</div>
    </div>

    <video id="input-video"></video>
    <div id="canvas-container"></div>

    <div id="card-stage">
        <div class="glass-card">
            <div style="font-size:12px; color:#ffd700; letter-spacing:4px; opacity:0.8;">BEST WISHES</div>
            <div class="big-word" id="ui-word"></div>
            <div style="width:50px; height:1px; background:rgba(255,255,255,0.3); margin: 0 auto 30px;"></div>
            <div class="big-desc" id="ui-desc"></div>
        </div>
    </div>

    <div id="hud">ğŸ–ï¸ äº”æŒ‡å¼ å¼€ / ğŸ–±ï¸ ç‚¹å‡»ç©ºç™½å¤„ï¼šè½¬åŠ¨ Â· âœŠ æ¡æ‹³ / ğŸ–±ï¸ ç‚¹å‡»å¡ç‰‡ï¼šæŠ½å–</div>

<script>
    // 1. æ•°æ®
    const moodData = [
        { "w": "æ˜¥é£åŒ–é›¨", "d": "æ„¿æ¸©æŸ”å¦‚ä½ ï¼Œæ¶¦ç‰©æ— å£°ï¼Œä¹Ÿè¢«ä¸–ç•Œæ¸©æŸ”ä»¥å¾…ã€‚" },
  { "w": "å¿ƒæ€€æ˜Ÿè¾°", "d": "å³ä½¿èº«å¤„é»‘å¤œï¼Œä¹Ÿåˆ«å¿˜äº†ä½ å¿ƒä¸­æœ‰å…‰ã€‚" },
  { "w": "æ­¥å±¥ä¸åœ", "d": "åªè¦è¿˜åœ¨èµ°ï¼Œå°±ç¦»æ¢¦æƒ³æ›´è¿‘ä¸€æ­¥ã€‚" },
  { "w": "ç¬‘é¥å¦‚èŠ±", "d": "ä½ çš„ç¬‘å®¹ï¼Œæ˜¯è¿™ä¸–ä¸Šæœ€åŠ¨äººçš„é£æ™¯ã€‚" },
  { "w": "è‡ªåœ¨å¦‚é£", "d": "ä¸è¢«å®šä¹‰ï¼Œä¸è¢«æŸç¼šï¼Œåšæœ€è‡ªç”±çš„è‡ªå·±ã€‚" },
  { "w": "é™å¾…èŠ±å¼€", "d": "æœ‰äº›ç¾å¥½ï¼Œéœ€è¦æ—¶é—´æ…¢æ…¢é…é…¿ã€‚" },
  { "w": "å±±é«˜æ°´é•¿", "d": "æƒ…è°Šä¸å› è·ç¦»è€Œæ·¡ï¼Œæ—¶å…‰ä¸å› å²æœˆè€Œè€ã€‚" },
  { "w": "äº‘æ·¡é£è½»", "d": "çœ‹æ·¡å¾—å¤±ï¼Œæ‰èƒ½æ´»å¾—è½»æ¾ã€‚" },
  { "w": "å¿ƒæœ‰æ‰€å‘", "d": "æ–¹å‘å¯¹äº†ï¼Œå°±ä¸æ€•è·¯è¿œã€‚" },
  { "w": "ç† ç† ç”Ÿè¾‰", "d": "ä½ æœ¬å°±å…‰èŠ’ä¸‡ä¸ˆï¼Œæ— éœ€å€Ÿè°çš„å…‰ã€‚" },
  { "w": "é¡ºé‚æ— å¿§", "d": "æ„¿ä½ æ‰€è¡Œçš†å¦é€”ï¼Œæ‰€æ„¿çš†å¯æœŸã€‚" },
  { "w": "æ¸©æŸ”åšå®š", "d": "æŸ”è½¯çš„å¿ƒï¼Œä¹Ÿèƒ½æ‰›èµ·æ•´ä¸ªä¸–ç•Œçš„é‡é‡ã€‚" },
  { "w": "ä¸è´ŸéŸ¶å", "d": "é’æ˜¥çŸ­æš‚ï¼Œä½†æ¯ä¸€åˆ»éƒ½å€¼å¾—å…¨åŠ›ä»¥èµ´ã€‚" },
  { "w": "å¿ƒå®‰å³æ˜¯å½’å¤„", "d": "æ— è®ºèº«åœ¨ä½•æ–¹ï¼Œå†…å¿ƒå®‰å®ä¾¿æ˜¯å®¶ã€‚" },
  { "w": "æŸ³æš—èŠ±æ˜", "d": "è½¬è§’ä¹‹å¤„ï¼Œæ€»æœ‰æƒŠå–œåœ¨ç­‰ä½ ã€‚" },
  { "w": "ä¹˜é£ç ´æµª", "d": "æ— æƒ§é£æµªï¼Œä½ å°±æ˜¯è‡ªå·±çš„èˆ¹é•¿ã€‚" },
  { "w": "æ¸…é£æœ—æœˆ", "d": "æ„¿ä½ å¿ƒä¸­å¸¸æœ‰æ˜æœˆï¼Œçœ¼ä¸­æœ‰æ¸…é£ã€‚" },
  { "w": "åšå¾·è½½ç‰©", "d": "å–„è‰¯ä¸åŒ…å®¹ï¼Œæ˜¯æœ€å¼ºå¤§çš„åŠ›é‡ã€‚" },
  { "w": "é”¦ä¸Šæ·»èŠ±", "d": "æ„¿ä½ åœ¨å¹¸ç¦ä¹‹ä¸Šï¼Œå†æ·»æ›´å¤šæ¬¢å–œã€‚" },
  { "w": "æµ·é˜”å¤©ç©º", "d": "å¿ƒæœ‰å¤šå¤§ï¼Œä¸–ç•Œå°±æœ‰å¤šå®½å¹¿ã€‚" },
  { "w": "å¿ƒèŠ±æ€’æ”¾", "d": "æ„¿æ¯ä¸€å¤©ï¼Œéƒ½æœ‰è®©ä½ å¼€å¿ƒçš„ç†ç”±ã€‚" },
  { "w": "å®‰ç„¶æ— æ™", "d": "å¹³å¹³å®‰å®‰ï¼Œå°±æ˜¯æœ€å¥½çš„ç¥ç¦ã€‚" },
  { "w": "æœæ°”è“¬å‹ƒ", "d": "å¹´è½»ä¸æ˜¯å¹´é¾„ï¼Œæ˜¯æ°¸è¿œå‘ä¸Šçš„å§¿æ€ã€‚" },
  { "w": "è½èŠ±æµæ°´", "d": "é¡ºå…¶è‡ªç„¶ï¼Œä¹Ÿæ˜¯ä¸€ç§æ™ºæ…§ã€‚" },
  { "w": "æ™´ç©ºä¸‡é‡Œ", "d": "é˜´éœ¾ç»ˆä¼šæ•£å»ï¼Œé˜³å…‰æ€»ä¼šå›æ¥ã€‚" },
  { "w": "ç¦æ˜Ÿé«˜ç…§", "d": "å¥½è¿æ­£åœ¨æ‚„æ‚„å‘ä½ é è¿‘ã€‚" },
  { "w": "å¿ƒé™è‡ªç„¶å‡‰", "d": "æµ®èºæ—¶ï¼Œä¸å¦¨æ·±å‘¼å¸ï¼Œæ‰¾å›å†…å¿ƒçš„å¹³é™ã€‚" },
  { "w": "ä¸€å¾€æ— å‰", "d": "è®¤å‡†äº†è·¯ï¼Œå°±åˆ«å›å¤´ã€‚" },
  { "w": "å²æœˆé™å¥½", "d": "æ„¿ä½ åœ¨å¹³å‡¡çš„æ—¥å­é‡Œï¼Œæ‰¾åˆ°ä¸å¹³å‡¡çš„å¿«ä¹ã€‚" },
  { "w": "å››æµ·å‡å¹³", "d": "ä¸–ç•Œå’Œå¹³ï¼Œäººé—´å®‰å®ï¼Œæ˜¯ä½ æˆ‘å…±åŒçš„æœŸç›¼ã€‚" },
  { "w": "é‡‘ç‰æ»¡å ‚", "d": "å¯Œè¶³ä¸ä»…æ˜¯è´¢å¯Œï¼Œæ›´æ˜¯å†…å¿ƒçš„ä¸°ç›ˆã€‚" },
  { "w": "å¿ƒæƒ³äº‹é¡º", "d": "å¿ƒä¹‹æ‰€å‘ï¼Œæ­¥æ­¥ç”Ÿè²ã€‚" },
  { "w": "å’Œå…‰åŒå°˜", "d": "ä½è°ƒè°¦å’Œï¼Œå´è‡ªæœ‰å…‰èŠ’ã€‚" },
  { "w": "ç”˜ä¹‹å¦‚é¥´", "d": "è‹¦ä¸­ä½œä¹ï¼Œæ˜¯æœ€é«˜çº§çš„æµªæ¼«ã€‚" },
  { "w": "æ‚ ç„¶è‡ªå¾—", "d": "æ…¢ä¸‹æ¥ï¼Œæ‰èƒ½çœ‹è§ç”Ÿæ´»çš„ç¾ã€‚" },
  { "w": "é¸¿è¿å½“å¤´", "d": "å±äºä½ çš„å¹¸è¿ï¼Œæ­£åœ¨è·¯ä¸Šã€‚" },
  { "w": "æ¸©æ¶¦å¦‚ç‰", "d": "æŸ”å’Œå´ä¸å¤±åŠ›é‡ï¼Œæ˜¯ä½ æœ€ç¾çš„æ ·å­ã€‚" },
  { "w": "æŠ«æ˜Ÿæˆ´æœˆ", "d": "ä¸ºæ¢¦æƒ³å¥”æ³¢çš„æ—¥å­ï¼Œç»ˆå°†ç…§äº®æœªæ¥ã€‚" },
  { "w": "æ˜¥æš–èŠ±å¼€", "d": "å¯’å†¬å·²è¿‡ï¼Œä¸‡ç‰©å¤è‹ï¼Œå¸Œæœ›å°±åœ¨å‰æ–¹ã€‚" },
  { "w": "å¿ƒæ€€æ„Ÿæ©", "d": "æ‡‚å¾—æ„Ÿæ©çš„äººï¼Œæ›´å®¹æ˜“è¢«å¹¸ç¦çœ·é¡¾ã€‚" },
  { "w": "æ‰¶æ‘‡ç›´ä¸Š", "d": "ç§¯è“„å·²ä¹…çš„åŠ›é‡ï¼Œç»ˆå°†å¸¦ä½ é£å‘é«˜å¤„ã€‚" },
  { "w": "å‰æ˜Ÿé«˜ç…§", "d": "å¤©é“é…¬å‹¤ï¼Œå¥½è¿å¸¸ä¼´åŠªåŠ›çš„äººã€‚" },
  { "w": "æ€¡ç„¶è‡ªä¹", "d": "ä¸€ä¸ªäººä¹Ÿèƒ½æ´»æˆä¸€æ”¯é˜Ÿä¼ï¼Œå¿«ä¹ç”±å¿ƒè€Œç”Ÿã€‚" },
  { "w": "é”¦ç»£å‰ç¨‹", "d": "ä½ çš„æœªæ¥ï¼Œæ¯”æƒ³è±¡ä¸­æ›´ç¿çƒ‚ã€‚" },
  { "w": "é£å’Œæ—¥ä¸½", "d": "å¥½å¤©æ°”é…å¥½å¿ƒæƒ…ï¼Œæ„¿ä½ å¤©å¤©å¦‚æ­¤ã€‚" },
  { "w": "å¿ƒæ—·ç¥æ€¡", "d": "æ”¾ä¸‹çƒ¦æ¼ï¼Œè®©å¿ƒçµå»æ—…è¡Œã€‚" },
  { "w": "ç¦æ…§åŒä¿®", "d": "æ—¢æœ‰ç¦æ°”ï¼Œä¹Ÿæœ‰æ™ºæ…§ï¼Œäººç”Ÿåœ†æ»¡ã€‚" },
  { "w": "ç¬‘å£å¸¸å¼€", "d": "ç¬‘å®¹æ˜¯æœ€å¥½çš„åŒ–å¦†å“ï¼Œä¹Ÿæ˜¯æœ€å¼ºçš„æ²»æ„ˆåŠ›ã€‚" },
  { "w": "å¦ææ³°æ¥", "d": "ä½è°·ä¹‹åï¼Œå¿…æœ‰å›å‡ã€‚" },
  { "w": "é¾™é©¬ç²¾ç¥", "d": "æ´»åŠ›æ»¡æ»¡ï¼Œå¹²åŠ²åè¶³ï¼Œè¿æ¥æ¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚" },
  { "w": "å®‰å±…ä¹ä¸š", "d": "æœ‰å®¶å¯å½’ï¼Œæœ‰æ¢¦å¯è¿½ï¼Œä¾¿æ˜¯äººé—´ç†æƒ³ã€‚" },
  { "w": "å¿ƒæ»¡æ„è¶³", "d": "çŸ¥è¶³è€…å¸¸ä¹ï¼Œæƒœç¦è€…å¸¸å®‰ã€‚" },
  { "w": "é¹ç¨‹ä¸‡é‡Œ", "d": "å¿—å­˜é«˜è¿œï¼Œç»ˆå°†ç¿±ç¿”ä¹å¤©ã€‚" },
  { "w": "ç‘é›ªå…†ä¸°å¹´", "d": "ä»Šæ—¥çš„ç§¯ç´¯ï¼Œæ˜¯æ˜æ—¥çš„ä¸°æ”¶ã€‚" },
  { "w": "å–œæ°”æ´‹æ´‹", "d": "æ„¿å–œæ‚¦å¦‚æ˜¥é£ï¼Œå¹è¿›ä½ ç”Ÿæ´»çš„æ¯ä¸ªè§’è½ã€‚" },
  { "w": "å¿ƒå¹³æ°”å’Œ", "d": "æƒ…ç»ªç¨³å®šï¼Œæ˜¯æˆå¹´äººæœ€é¡¶çº§çš„è‡ªå¾‹ã€‚" },
  { "w": "è’¸è’¸æ—¥ä¸Š", "d": "äº‹ä¸šã€ç”Ÿæ´»ã€å¿ƒæƒ…ï¼Œä¸€å¤©æ¯”ä¸€å¤©æ›´å¥½ã€‚" },
  { "w": "å‰ç¥¥å¦‚æ„", "d": "æ‰€æ±‚çš†å¦‚æ„¿ï¼Œæ‰€è¡ŒåŒ–å¦é€”ã€‚" },
  { "w": "å®é™è‡´è¿œ", "d": "æ²‰å¾—ä½æ°”ï¼Œæ‰èƒ½èµ°å¾—æ›´è¿œã€‚" },
  { "w": "èŠ±å¼€å¯Œè´µ", "d": "æ„¿ä½ çš„ç”Ÿæ´»å¦‚ç¹èŠ±èˆ¬ç»šçƒ‚å¤šå½©ã€‚" },
  { "w": "ä¸€å¸†é£é¡º", "d": "å‰è·¯è™½è¿œï¼Œä½†é£æ­£åŠ©ä½ æ‰¬å¸†ã€‚" },
  { "w": "å¿ƒæ€€æ¢¦æƒ³", "d": "æœ‰æ¢¦çš„äººï¼Œæ°¸è¿œä¸ä¼šè¿·å¤±æ–¹å‘ã€‚" },
  { "w": "ç¦å¯¿å®‰åº·", "d": "å¥åº·æ˜¯ç¦ï¼Œå¹³å®‰æ˜¯å¯¿ï¼Œæ„¿ä½ äºŒè€…å…¼å¾—ã€‚" },
  { "w": "ä¹å–„å¥½æ–½", "d": "å–„è‰¯æ˜¯ç§å­ï¼Œç»ˆå°†å¼€å‡ºå¹¸ç¦çš„èŠ±ã€‚" },
  { "w": "è±è¾¾å¼€æœ—", "d": "å¿ƒå®½ä¸€å¯¸ï¼Œè·¯å®½ä¸€ä¸ˆã€‚" },
  { "w": "å¤©é“é…¬å‹¤", "d": "ä½ ä»˜å‡ºçš„æ¯ä¸€åˆ†åŠªåŠ›ï¼Œéƒ½ä¸ä¼šè¢«è¾œè´Ÿã€‚" },
  { "w": "å¿ƒéšæ‰€æ„¿", "d": "æ„¿ä½ å¿ƒä¹‹æ‰€å‘ï¼Œçš†èƒ½æŠµè¾¾ã€‚" },
  { "w": "äº”ç¦ä¸´é—¨", "d": "ç¦ã€ç¦„ã€å¯¿ã€å–œã€è´¢ï¼Œæ ·æ ·ä¸ç¼ºã€‚" },
  { "w": "ä»å®¹ä¸è¿«", "d": "ä¸æ…Œä¸å¿™ï¼Œæ‰æ˜¯åº”å¯¹ç”Ÿæ´»çš„æœ€å¥½å§¿æ€ã€‚" },
  { "w": "å¿ƒæœ‰æ‰€ä¾", "d": "æœ‰äººç‰µæŒ‚ï¼Œæœ‰çˆ±å¯ä¾ï¼Œä¾¿æ˜¯äººé—´å€¼å¾—ã€‚" },
  { "w": "ä¸‡è±¡æ›´æ–°", "d": "æ–°çš„ä¸€å¹´ï¼Œæ–°çš„å¼€å§‹ï¼Œä¸€åˆ‡éƒ½ä¼šæ›´å¥½ã€‚" },
  { "w": "æ˜¥é£å¾—æ„", "d": "å¥½äº‹è¿è¿ï¼Œå¿ƒæƒ…èˆ’ç•…ï¼Œæ­£æ˜¯äººç”Ÿå¥½æ—¶èŠ‚ã€‚" },
  { "w": "å¿ƒæ€€æš–é˜³", "d": "å³ä½¿åœ¨å¯’å†¬ï¼Œä¹Ÿèƒ½æ¸©æš–è‡ªå·±å’Œä»–äººã€‚" },
  { "w": "é’äº‘ç›´ä¸Š", "d": "æ‰åä¸åŠªåŠ›ï¼Œç»ˆå°†å¸¦ä½ ç™»ä¸Šé«˜å³°ã€‚" },
  { "w": "å®¶å’Œä¸‡äº‹å…´", "d": "å’Œç¦çš„å®¶åº­ï¼Œæ˜¯å¹¸ç¦çš„æºæ³‰ã€‚" },
  { "w": "å¿ƒæ€€å–„æ„", "d": "å–„è‰¯æ˜¯ä½ æœ€ç¾çš„åº•è‰²ã€‚" },
  { "w": "æ—¥è¿›æ–—é‡‘", "d": "è´¢å¯Œæºæºä¸æ–­ï¼Œç”Ÿæ´»è¶Šæ¥è¶Šå¯Œè¶³ã€‚" },
  { "w": "å¿ƒæ€€çƒ­çˆ±", "d": "å› ä¸ºçƒ­çˆ±ï¼Œæ‰€ä»¥åšæŒï¼›å› ä¸ºåšæŒï¼Œæ‰€ä»¥é—ªè€€ã€‚" },
  { "w": "å²å²å¹³å®‰", "d": "å¹´å¹´æœ‰ä»Šæ—¥ï¼Œå²å²çš†æ¬¢æ„‰ã€‚" },
  { "w": "å¿ƒæ€€å¸Œæœ›", "d": "åªè¦è¿˜æœ‰å¸Œæœ›ï¼Œå°±æ°¸è¿œæœ‰æ˜å¤©ã€‚" },
  { "w": "é£ç”Ÿæ°´èµ·", "d": "äº‹ä¸šå¦‚æ½®æ¶Œï¼Œç”Ÿæ´»ä¼¼èŠ±å¼€ã€‚" },
  { "w": "å¿ƒæ€€èµ¤è¯š", "d": "çœŸè¯šå¾…äººï¼Œç»ˆå°†æ”¶è·çœŸå¿ƒã€‚" },
  { "w": "ç¦æ³½ç»µé•¿", "d": "ç¦æ°”å¦‚æ±Ÿæ²³ï¼Œç»µå»¶ä¸ç»ã€‚" },
  { "w": "å¿ƒæ€€å‹‡æ°”", "d": "å‹‡æ•¢ä¸æ˜¯ä¸å®³æ€•ï¼Œè€Œæ˜¯å¸¦ç€å®³æ€•ä¾ç„¶å‰è¡Œã€‚" },
  { "w": "èŠ±å¼€æ»¡å›­", "d": "æ„¿ä½ çš„åŠªåŠ›ï¼Œç»“å‡ºæ»¡å›­èŠ¬èŠ³ã€‚" },
  { "w": "å¿ƒæ€€è‡ªç”±", "d": "çµé­‚è‡ªç”±ï¼Œè„šæ­¥æ‰ä¸ä¼šè¢«æŸç¼šã€‚" },
  { "w": "é¡ºå¿ƒå¦‚æ„", "d": "äº‹äº‹ç§°å¿ƒï¼Œæ—¶æ—¶æ¬¢å–œã€‚" },
  { "w": "å¿ƒæ€€è¯—æ„", "d": "åœ¨å¹³å‡¡ä¸­çœ‹è§ç¾ï¼Œæ˜¯ç”Ÿæ´»çš„è‰ºæœ¯ã€‚" },
  { "w": "ç¦æ°”æ»¡æ»¡", "d": "å¥½è¿å¸¸ä¼´ï¼Œå–œäº‹è¿è¿ã€‚" },
  { "w": "å¿ƒæ€€è¿œæ–¹", "d": "ç›®å…‰æ‰€åŠæ˜¯è¿œæ–¹ï¼Œè„šä¸‹æ‰€è¡Œæ˜¯å¾é€”ã€‚" },
  { "w": "å–œä¹å®‰åº·", "d": "å¿«ä¹å¸¸åœ¨ï¼Œèº«ä½“åº·å¥ï¼Œèƒœè¿‡åƒé‡‘ã€‚" },
  { "w": "å¿ƒæ€€å…‰æ˜", "d": "é»‘æš—å†é•¿ï¼Œä¹ŸæŒ¡ä¸ä½ä½ å¿ƒä¸­çš„å…‰ã€‚" },
  { "w": "è¯¸äº‹é¡ºé‚", "d": "å·¥ä½œé¡ºåˆ©ï¼Œç”Ÿæ´»å¦‚æ„ï¼Œå¿ƒæƒ…èˆ’ç•…ã€‚" },
  { "w": "å¿ƒæ€€æŸ”æƒ…", "d": "åˆšå¼ºä¹‹ä¸­ä¸å¤±æ¸©æŸ”ï¼Œæ˜¯æœ€åŠ¨äººçš„åŠ›é‡ã€‚" },
  { "w": "ç¦å¦‚ä¸œæµ·", "d": "ç¦æ°”æµ©ç€šå¦‚æµ·ï¼Œç»µå»¶ä¸ç»ã€‚" },
  { "w": "å¿ƒæ€€æ•¬ç•", "d": "æ•¬å¤©çˆ±äººï¼Œæ–¹èƒ½è¡Œç¨³è‡´è¿œã€‚" },
  { "w": "å¯¿æ¯”å—å±±", "d": "å¥åº·é•¿å¯¿ï¼Œç¦å¯¿åŒå…¨ã€‚" },
  { "w": "å¿ƒæ€€çº¯ç²¹", "d": "ä¿æŒåˆå¿ƒï¼Œä¸æŸ“å°˜åŸƒï¼Œæ˜¯æœ€çè´µçš„å“è´¨ã€‚" },
  { "w": "å¹¸ç¦å®‰åº·", "d": "å¹¸ç¦å¾ˆç®€å•ï¼šæœ‰äººçˆ±ï¼Œæœ‰äº‹åšï¼Œæœ‰æœŸå¾…ã€‚" },
  { "w": "å¿ƒæ€€è¾½é˜”", "d": "å¿ƒè‹¥å¤§æµ·ï¼Œä¾¿å®¹å¾—ä¸‹æ‰€æœ‰é£é›¨ã€‚" },
  { "w": "å–œä»å¤©é™", "d": "æƒŠå–œæ€»åœ¨ä¸ç»æ„é—´é™ä¸´ã€‚" },
  { "w": "å¿ƒæ€€åšå®š", "d": "ä¿¡å¿µå¦‚ç£çŸ³ï¼Œé£é›¨ä¸åŠ¨æ‘‡ã€‚" },
  { "w": "ç¦è‡³å¿ƒçµ", "d": "å¥½è¿æ¥äº†ï¼Œçµæ„Ÿä¹Ÿä¼šéšä¹‹è€Œæ¥ã€‚" },
  { "w": "å¿ƒæ€€æ„Ÿæ©", "d": "æ„Ÿæ©æ‹¥æœ‰ï¼Œçæƒœå½“ä¸‹ï¼Œå¹¸ç¦è‡ªæ¥ã€‚" },
  { "w": "ä¸‡äº‹å¦‚æ„", "d": "æ„¿ä½ æ‰€æ±‚çš†æ‰€å¾—ï¼Œæ‰€è¡ŒåŒ–å¦é€”ã€‚" }
    ];
    while(moodData.length < 100) {
        moodData.push(moodData[Math.floor(Math.random()*moodData.length)]);
    }

    // 2. Three.js
    let scene, camera, renderer;
    let sphereGroup, cardMeshes = [];
    let meteorSystem; 

    function initThree() {
        const container = document.getElementById('canvas-container');
        scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x0e1520, 0.012);

        camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 60; 

        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // A. çœŸè¨€æ˜Ÿçƒ
        sphereGroup = new THREE.Group();
        scene.add(sphereGroup);

        const core = new THREE.Mesh(
            new THREE.SphereGeometry(15, 32, 32),
            new THREE.MeshBasicMaterial({ color: 0x001133, transparent: true, opacity: 0.6 })
        );
        sphereGroup.add(core);

        const cardGeo = new THREE.PlaneGeometry(3.5, 5.0); 
        const radius = 30; 
        const phi = Math.PI * (3 - Math.sqrt(5)); 

        moodData.forEach((item, i) => {
            const texture = createCardTexture(item.w, item.d, i);
            const mat = new THREE.MeshBasicMaterial({
                map: texture, transparent: true, side: THREE.DoubleSide,
                depthWrite: false, blending: THREE.AdditiveBlending 
            });
            const mesh = new THREE.Mesh(cardGeo, mat);

            const y = 1 - (i / (moodData.length - 1)) * 2;
            const r = Math.sqrt(1 - y * y);
            const theta = phi * i;
            const x = Math.cos(theta) * r;
            const z = Math.sin(theta) * r;

            const pos = new THREE.Vector3(x * radius, y * radius, z * radius);
            mesh.position.copy(pos);
            mesh.lookAt(mesh.position.clone().multiplyScalar(2)); 
            
            mesh.userData = { originalPos: pos.clone() };
            sphereGroup.add(mesh);
            cardMeshes.push(mesh);
        });

        // B. äº”å½©æµæ˜Ÿé›¨
        const meteorCount = 200;
        const meteorGeo = new THREE.BufferGeometry();
        const positions = new Float32Array(meteorCount * 6); 
        const colors = new Float32Array(meteorCount * 6);
        const meteorData = []; 
        const palette = [new THREE.Color(0xffd700), new THREE.Color(0x00f3ff), new THREE.Color(0xff0055), new THREE.Color(0xbc13fe)];

        for(let i=0; i<meteorCount; i++) {
            const x = (Math.random() - 0.5) * 500;
            const y = (Math.random() - 0.5) * 500;
            const z = (Math.random() - 0.5) * 600 - 100; 
            const len = 20 + Math.random() * 30; 

            positions[i*6] = x; positions[i*6+1] = y; positions[i*6+2] = z;
            positions[i*6+3] = x; positions[i*6+4] = y; positions[i*6+5] = z - len;

            const col = palette[Math.floor(Math.random() * palette.length)];
            colors[i*6] = col.r; colors[i*6+1] = col.g; colors[i*6+2] = col.b;
            colors[i*6+3] = col.r * 0.5; colors[i*6+4] = col.g * 0.5; colors[i*6+5] = col.b * 0.5;

            meteorData.push({ speed: 1 + Math.random() * 2, len: len });
        }

        meteorGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        meteorGeo.setAttribute('color', new THREE.BufferAttribute(colors, 3));
        const meteorMat = new THREE.LineBasicMaterial({ vertexColors: true, transparent: true, opacity: 0.6, blending: THREE.AdditiveBlending });
        meteorSystem = new THREE.LineSegments(meteorGeo, meteorMat);
        meteorSystem.userData = { data: meteorData };
        scene.add(meteorSystem);
    }

    function createCardTexture(word, desc, index) {
        const canvas = document.createElement('canvas');
        canvas.width = 256; canvas.height = 360; 
        const ctx = canvas.getContext('2d');
        const grad = ctx.createLinearGradient(0,0,0,360);
        grad.addColorStop(0, 'rgba(0, 30, 60, 0.5)');
        grad.addColorStop(1, 'rgba(0, 10, 20, 0.2)');
        ctx.fillStyle = grad;
        ctx.fillRect(0,0,256,360);
        ctx.strokeStyle = `hsl(${Math.random()*360}, 70%, 60%)`; 
        ctx.lineWidth = 5;
        ctx.strokeRect(5,5,246,350);
        ctx.fillStyle = '#ffffff';
        ctx.font = 'bold 50px "Microsoft YaHei"';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.shadowColor = ctx.strokeStyle;
        ctx.shadowBlur = 15;
        ctx.fillText(word, 128, 140);
        const shortDesc = desc.length > 9 ? desc.substring(0,8) + ".." : desc;
        ctx.font = '20px "Microsoft YaHei"';
        ctx.shadowBlur = 0;
        ctx.fillStyle = '#ddeeff';
        ctx.fillText(shortDesc, 128, 220);
        return new THREE.CanvasTexture(canvas);
    }

    // 3. äº¤äº’é€»è¾‘
    const STATE = { IDLE: 0, SHOWING: 1, DISMISSING: 2 };
    let currentState = STATE.IDLE;
    let sphereRadiusExtra = 0;
    const uiStage = document.getElementById('card-stage');
    const uiWord = document.getElementById('ui-word');
    const uiDesc = document.getElementById('ui-desc');

    function actionDraw() {
        if(currentState !== STATE.IDLE) return;
        const item = moodData[Math.floor(Math.random()*moodData.length)];
        uiWord.innerText = item.w;
        uiDesc.innerText = item.d;
        currentState = STATE.SHOWING;
        uiStage.classList.add('active');
        sphereRadiusExtra = 40; 
    }

    function actionDismiss() {
        if(currentState !== STATE.SHOWING) return;
        currentState = STATE.DISMISSING;
        uiStage.classList.remove('active');
        setTimeout(() => currentState = STATE.IDLE, 1000);
    }

    // ç‚¹å‡»äº¤äº’ (Fallback)
    document.addEventListener('click', (e) => {
        if(document.getElementById('loading-screen').style.display !== 'none') return;
        
        if(currentState === STATE.IDLE) {
            actionDraw();
        } else if (currentState === STATE.SHOWING) {
            actionDismiss();
        }
    });

    // 4. MediaPipe & å¯åŠ¨æ§åˆ¶
    let handsInstance = null;
    let cameraInstance = null;
    
    // å¼ºåˆ¶å¼€å§‹ (è·³è¿‡ç­‰å¾…)
    window.forceStart = function() {
        const loadDiv = document.getElementById('loading-screen');
        loadDiv.style.opacity = '0';
        setTimeout(() => loadDiv.style.display = 'none', 800);
        document.getElementById('hud').innerText = "ğŸ–±ï¸ ç‚¹å‡»å±å¹•ä»»æ„ä½ç½®è¿›è¡ŒæŠ½å¡";
    }

    async function startVision() {
        const loadTxt = document.getElementById('load-txt');
        const subTxt = document.getElementById('sub-txt');

        // è®¾ç½®5ç§’è¶…æ—¶ï¼Œå¦‚æœåŠ è½½å¡ä½ï¼Œè‡ªåŠ¨è¿›å…¥ç‚¹å‡»æ¨¡å¼
        const timeoutId = setTimeout(() => {
            if(document.getElementById('loading-screen').style.display !== 'none') {
                console.log("Vision load timed out, enabling mouse mode.");
                forceStart();
            }
        }, 5000);

        try {
            loadTxt.innerText = "æ­£åœ¨é“¾æ¥è§†è§‰ç¥ç»...";
            handsInstance = new Hands({locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`});
            handsInstance.setOptions({ maxNumHands: 1, modelComplexity: 1, minDetectionConfidence: 0.6 });

            let cooldown = 0;
            handsInstance.onResults(results => {
                // æˆåŠŸæ£€æµ‹åˆ°ç”»é¢
                clearTimeout(timeoutId); 
                const loadDiv = document.getElementById('loading-screen');
                if(loadDiv.style.opacity !== '0') {
                    loadDiv.style.opacity = '0';
                    setTimeout(() => loadDiv.style.display='none', 800);
                }

                if(results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                    const lm = results.multiHandLandmarks[0];
                    const tips=[8,12,16,20], pips=[6,10,14,18];
                    let f = 0;
                    tips.forEach((t,i) => { if(lm[t].y < lm[pips[i]].y) f++; });
                    if(lm[4].x < lm[3].x) f++; 

                    if(cooldown > 0) { cooldown--; return; }
                    if(f <= 1 && currentState === STATE.IDLE) { actionDraw(); cooldown = 40; }
                    else if(f >= 4 && currentState === STATE.SHOWING) { actionDismiss(); cooldown = 40; }
                }
            });

            const vid = document.getElementById('input-video');
            cameraInstance = new Camera(vid, { 
                onFrame: async()=>{ await handsInstance.send({image:vid}) }, 
                width:640, height:480 
            });
            await cameraInstance.start();
        } catch(e) {
            console.error(e);
            loadTxt.innerText = "æ— æ³•å¯åŠ¨æ‘„åƒå¤´";
            subTxt.innerText = "å·²è‡ªåŠ¨åˆ‡æ¢ä¸ºç‚¹å‡»æ¨¡å¼";
            subTxt.style.color = "#ffd700";
            setTimeout(forceStart, 1500);
        }
    }

    // 5. åŠ¨ç”»å¾ªç¯
    const clock = new THREE.Clock();
    function animate() {
        requestAnimationFrame(animate);
        const time = clock.getElapsedTime();

        // æ˜ŸçƒåŠ¨ç”»
        sphereGroup.rotation.y += 0.002;
        sphereGroup.rotation.x = Math.sin(time * 0.2) * 0.05;
        const targetR = (currentState === STATE.SHOWING) ? 30 : 0;
        sphereRadiusExtra += (targetR - sphereRadiusExtra) * 0.05;

        cardMeshes.forEach((mesh, i) => {
            const ud = mesh.userData;
            const dir = ud.originalPos.clone().normalize();
            const dist = ud.originalPos.length() + sphereRadiusExtra + Math.sin(time*2 + i)*0.5;
            mesh.position.copy(dir.multiplyScalar(dist));
            mesh.lookAt(mesh.position.clone().multiplyScalar(2)); 
        });

        // æµæ˜ŸåŠ¨ç”»
        if(meteorSystem) {
            const positions = meteorSystem.geometry.attributes.position.array;
            const data = meteorSystem.userData.data;
            for(let i=0; i<data.length; i++) {
                const speed = data[i].speed * (currentState === STATE.SHOWING ? 4 : 0.5); 
                positions[i*6+2] += speed; positions[i*6+5] += speed;
                if(positions[i*6+2] > 80) {
                    const zReset = -200 - Math.random() * 100;
                    const xReset = (Math.random() - 0.5) * 500;
                    const yReset = (Math.random() - 0.5) * 500;
                    positions[i*6] = xReset; positions[i*6+1] = yReset; positions[i*6+2] = zReset;
                    positions[i*6+3] = xReset; positions[i*6+4] = yReset; positions[i*6+5] = zReset - data[i].len;
                }
            }
            meteorSystem.geometry.attributes.position.needsUpdate = true;
        }
        renderer.render(scene, camera);
    }

    window.onload = () => {
        if(!window.THREE) { alert("èµ„æºåŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ"); return; }
        initThree();
        animate();
        startVision();
        
        window.addEventListener('resize', () => {
            camera.aspect=window.innerWidth/window.innerHeight; camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth,window.innerHeight);
        });
    };
</script>
</body>
</html>